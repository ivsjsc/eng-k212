# Hướng dẫn Kiểm tra Cải tiến - IVS English K-12 Learning App

## 📋 Mục lục
1. [Tổng quan Cải tiến](#tổng-quan-cải-tiến)
2. [Hướng dẫn Test Ebook](#hướng-dẫn-test-ebook)
3. [Hướng dẫn Test Bộ lọc Chương trình](#hướng-dẫn-test-bộ-lọc-chương-trình)
4. [Các Vấn đề Thường gặp](#các-vấn-đề-thường-gặp)

---

## 🎯 Tổng quan Cải tiến

### Những gì đã được cải tiến:

#### ✅ 1. Thêm Ebook cho THCS & THPT
- **Lớp 6-9**: i-Learn Smart World 6, 7, 8, 9
- **Lớp 10-12**: Tiếng Anh 10, 11, 12 - Global Success

#### ✅ 2. Sửa URL Ebook PDF
- URL Google Drive cho lớp 9 đã được chuẩn hóa
- Tất cả các lớp 10-12 có URL hợp lệ

#### ✅ 3. Cải thiện Bộ lọc Chương trình
- Học sinh ở cấp THCS (6-9) và THPT (10-12) giờ đây có thể xem chương trình phù hợp
- Logic lọc đã được tối ưu hóa

---

## 📚 Hướng dẫn Test Ebook

### Test 1: Kiểm tra Ebook trong Curriculum

#### Bước 1: Đăng nhập với vai trò Học sinh
```
1. Mở ứng dụng
2. Chọn "Khách" (Guest)
3. Chọn vai trò "Học sinh" (Student)
```

#### Bước 2: Chọn cấp học THCS (Lớp 6-9)
```
1. Vào "Cài đặt" > "Hồ sơ"
2. Chọn cấp học: "6", "7", "8", hoặc "9"
3. Lưu thay đổi
```

#### Bước 3: Xem Chương trình
```
1. Vào menu "Chương trình"
2. Kiểm tra xem có hiển thị "Trung học IVS-Mastery" không
3. Các khóa học nên bao gồm:
   - i-Learn Smart World 6
   - i-Learn Smart World 7
   - i-Learn Smart World 8
   - i-Learn Smart World 9
```

#### Bước 4: Test Ebook
```
1. Nhấp vào một khóa học (ví dụ: i-Learn Smart World 9)
2. Tìm nút "Xem Ebook" (View Ebook)
3. Nhấp vào nút này
4. Ebook sẽ mở trong tab mới (Google Drive)
```

#### ✅ Kết quả mong đợi:
- Ebook mở thành công
- Nội dung hiển thị đầy đủ
- Có thể xem và tải về

### Test 2: Kiểm tra Ebook THPT (Lớp 10-12)

#### Bước 1: Thay đổi cấp học
```
1. Vào "Cài đặt" > "Hồ sơ"
2. Chọn cấp học: "10", "11", hoặc "12"
3. Lưu thay đổi
```

#### Bước 2: Xem Chương trình THPT
```
1. Vào menu "Chương trình"
2. Kiểm tra xem có hiển thị "Trung học phổ thông IVS-Mastery" không
3. Các khóa học nên bao gồm:
   - Tiếng Anh 10 - Global Success
   - Tiếng Anh 11 - Global Success
   - Tiếng Anh 12 - Global Success
```

#### Bước 3: Test Ebook cho từng lớp
```
Lặp lại Bước 4 từ Test 1 cho mỗi lớp 10, 11, 12
```

---

## 🎓 Hướng dẫn Test Bộ lọc Chương trình

### Test 3: Kiểm tra Bộ lọc theo Cấp học

#### Scenario 1: Học sinh Tiểu học (Lớp 1-5)
```
1. Chọn cấp học: "1", "2", "3", "4", hoặc "5"
2. Vào "Chương trình"
3. Kiểm tra: Chỉ hiển thị "Tiểu học IVS-Mastery"
4. Các khóa học: Super Minds Starter, SM1, SM2, SM3, SM4
```

#### ✅ Kết quả mong đợi:
- Không hiển thị chương trình Mầm non
- Không hiển thị chương trình THCS
- Không hiển thị chương trình THPT

#### Scenario 2: Học sinh THCS (Lớp 6-9)
```
1. Chọn cấp học: "6", "7", "8", hoặc "9"
2. Vào "Chương trình"
3. Kiểm tra: Chỉ hiển thị "Trung học IVS-Mastery"
4. Các khóa học: SW6, SW7, SW8, SW9
```

#### ✅ Kết quả mong đợi:
- Không hiển thị chương trình Tiểu học
- Không hiển thị chương trình THPT
- **QUAN TRỌNG**: Không có thông báo "Không có chương trình khớp với cấp học"

#### Scenario 3: Học sinh THPT (Lớp 10-12)
```
1. Chọn cấp học: "10", "11", hoặc "12"
2. Vào "Chương trình"
3. Kiểm tra: Chỉ hiển thị "Trung học phổ thông IVS-Mastery"
4. Các khóa học: G10, G11, G12
```

#### ✅ Kết quả mong đợi:
- Không hiển thị chương trình Tiểu học
- Không hiển thị chương trình THCS
- **QUAN TRỌNG**: Không có thông báo "Không có chương trình khớp với cấp học"

### Test 4: Giáo viên xem tất cả Chương trình

#### Bước 1: Đăng nhập với vai trò Giáo viên
```
1. Đăng xuất
2. Đăng nhập lại với vai trò "Giáo viên" (Teacher)
```

#### Bước 2: Xem Chương trình
```
1. Vào menu "Chương trình"
2. Kiểm tra: Hiển thị TẤT CẢ các chương trình
   - Mầm non IVS-Mastery (4 khóa)
   - Tiểu học IVS-Mastery (5 khóa)
   - Trung học IVS-Mastery (4 khóa)
   - Trung học phổ thông IVS-Mastery (3 khóa)
```

#### ✅ Kết quả mong đợi:
- Giáo viên nhìn thấy tất cả 16 khóa học
- Có thể truy cập ebook cho tất cả các lớp
- Không bị giới hạn bởi grade level

---

## 🔧 Test với Developer Tools

### Debug Mode

Ứng dụng có một chế độ debug để kiểm tra bộ lọc:

```
1. Vào "Chương trình"
2. Nhấp vào icon (i) bên cạnh tiêu đề
3. Xem thông tin debug:
   - user.gradeLevel: Cấp học hiện tại
   - normalized: Cấp học sau khi chuẩn hóa
   - filtered categories: Số category sau khi lọc
   - effective categories: Số category thực tế hiển thị
```

### Console Logs

Mở Developer Console (F12) để xem logs:

```javascript
// Expected logs when viewing Curriculum:
[Curriculum] total categories: 4 
[Curriculum] user.gradeLevel: 9
[Curriculum] normalized: secondary
[Curriculum] filtered categories: 1
[Curriculum] effective categories: 1
```

---

## ❓ Các Vấn đề Thường gặp

### Vấn đề 1: "Không có chương trình khớp với cấp học"

**Nguyên nhân**: Logic lọc không khớp với tên category

**Giải pháp**: 
```
✅ ĐÃ SỬA trong phiên bản hiện tại
Nếu vẫn gặp vấn đề, kiểm tra:
1. Grade level trong Settings > Profile
2. Xóa cache và reload trang
3. Kiểm tra console logs
```

### Vấn đề 2: Ebook không mở

**Nguyên nhân**: URL Google Drive không hợp lệ hoặc file chưa được chia sẻ

**Giải pháp**:
```
1. Kiểm tra URL trong Developer Console
2. Đảm bảo file có quyền "Anyone with the link"
3. Thử mở URL trực tiếp trong trình duyệt
```

### Vấn đề 3: Ebook hiển thị lỗi 404

**Nguyên nhân**: Assets chưa được upload vào `/public/assets/`

**Giải pháp**:
```
1. Kiểm tra thư mục /public/assets/sw9/
2. Upload các file page-1.jpg, page-2.jpg, ...
3. Hoặc cập nhật số trang trong ebooks.ts
```

### Vấn đề 4: Chương trình không lọc đúng

**Nguyên nhân**: Grade level chưa được cập nhật

**Giải pháp**:
```
1. Vào Settings > Profile
2. Chọn cấp học rõ ràng (1-12)
3. Lưu và reload trang
4. Kiểm tra debug mode để xác nhận
```

---

## 🧪 Chạy Automated Tests

### Sử dụng Test Script

```bash
# Di chuyển đến thư mục dự án
cd e:\IVS\Apps\eng-k212

# Chạy test script
node scripts/test-improvements.js
```

### Expected Output:
```
🧪 Testing IVS English K-12 Learning App Improvements...

📚 Test 1: Ebook Data Coverage
================================
✅ PASS: All grades (6-12) have ebook data
   Total ebook entries: 7

📖 Test 2: Curriculum Coverage
================================
   Total curriculum levels: 16
   - Kindergarten IVS-Mastery: 4 courses
   - Primary IVS-Mastery: 5 courses
   - Secondary IVS-Mastery: 4 courses
   - Highschool IVS-Mastery: 3 courses

🔗 Test 3: Ebook PDF URLs Validation
================================
✅ PASS: All ebook PDF URLs are valid

... (more tests)
```

---

## 📝 Checklist Hoàn chỉnh

### Before Testing:
- [ ] Build ứng dụng mới nhất: `npm run build`
- [ ] Start dev server: `npm run dev`
- [ ] Xóa cache trình duyệt
- [ ] Mở Developer Console

### During Testing:
- [ ] Test với vai trò Học sinh (Student)
- [ ] Test với vai trò Giáo viên (Teacher)
- [ ] Test tất cả các cấp học (1-12)
- [ ] Test Ebook cho THCS & THPT
- [ ] Kiểm tra debug logs
- [ ] Chạy automated test script

### After Testing:
- [ ] Ghi nhận các lỗi (nếu có)
- [ ] Cập nhật IMPROVEMENTS_LOG.md
- [ ] Commit changes
- [ ] Deploy lên production (nếu pass tất cả tests)

---

## 🎉 Kết luận

Nếu tất cả các tests trên đều PASS, các cải tiến đã hoạt động đúng!

**Các cải tiến chính:**
- ✅ Ebook cho lớp 6-12 đã được thêm
- ✅ Bộ lọc chương trình hoạt động chính xác
- ✅ Học sinh THCS & THPT có trải nghiệm tốt hơn

**Vấn đề còn lại:** (Xem IMPROVEMENTS_LOG.md)
- 🔴 Lộ trình học tập chưa hoạt động
- 🔴 Chức năng AI chỉ là mẫu thử
- 🟡 Trải nghiệm khách hạn chế

---

**Cập nhật**: 6/10/2025  
**Version**: 1.0  
**Tác giả**: GitHub Copilot
